%{
#include <string>

%}

TypeChar "char"
TypeString "string"
TypeInt "int"
TypeVoid "void"
TypeFloat "float"
TypeDouble "double"
TypeBool "bool"

ModifierUnsigned "unsigned"
ModifierSigned "signed"
ModifierShort "short"
ModifierLong "long"

Return "return"
Cout	"cout"

Space [ \t]
Delim {Space}+
Line [\n]

Digit [0-9]
Num {Digit}+
Letter [A-Za-z_]
Int {Num}
Float {Int}(\.{Num})
Scientific ({Int}|{Float})[e|E][+|-]{Num}
True "true"
False "false"
Bool {True}|{False}

Char \'({Letter}|{Num})\'
ID {Letter}({Letter}|{Num})*
String "\""([^\n\"\\]*(\\[.\n])*)*"\""

OpSum [+]
OpSub [-]
OpMult [*]
OpDiv [/]
OpMod "%"

OpRelLess "<"
OpRelGreater ">"
OpRelEqLess "<="
OpRelEqGreater ">="
OpRelEq "=="
OpRelDiff "!="

OpLogicAnd "&&"
OpLogicOr "||"
OpLogicNot "!"

OpLogicBinAnd "&"
OpLogicBinOr "|"
OpLogicBinXor "^"
OpLogicBinNot "~"
OpLogicBinShiftR ">>"
OpLogicBinShiftL "<<"

Assign "="

%x COMMENTS
%x COMMENTS_2
%%

"/*"			{BEGIN(COMMENTS);}
<COMMENTS>"*"+"/" 	{BEGIN(INITIAL);}
<COMMENTS>[^*\n]*	{}
<COMMENTS>"*"+[^*/\n]*	{}
<COMMENTS>\n     	{ ++yylineno; }


"//"			{BEGIN(COMMENTS_2);}
<COMMENTS_2>[\0] 	{; BEGIN(INITIAL);}
<COMMENTS_2>[\n] 	{ ++yylineno; BEGIN(INITIAL);}
<COMMENTS_2>[^\n]*	{}


{Delim} 	{}
{Line}		{yylineno++;}

"main"		{return TK_MAIN;}

[(){}[\];,]	{ return *yytext; }

{OpSum}		{yylval.translation = yytext; return TK_OP_SUM; }
{OpSub}		{yylval.translation = yytext; return TK_OP_SUB; }
{OpMult}	{yylval.translation = yytext; return TK_OP_MUL; }
{OpDiv}		{yylval.translation = yytext; return TK_OP_DIV; }
{OpMod}		{yylval.translation = yytext; return TK_OP_MOD; }


{OpRelLess}			{yylval.translation = yytext; return TK_OP_REL_LESS; }
{OpRelGreater}		{yylval.translation = yytext; return TK_OP_REL_GREATER; }
{OpRelEqLess}		{yylval.translation = yytext; return TK_OP_REL_EQLESS; }
{OpRelEqGreater}	{yylval.translation = yytext; return TK_OP_REL_EQGREATER; }
{OpRelEq}			{yylval.translation = yytext; return TK_OP_REL_EQ; }
{OpRelDiff}			{yylval.translation = yytext; return TK_OP_REL_DIFF; }

{OpLogicAnd}		{yylval.translation = yytext; return TK_OP_LOGIC_AND; }
{OpLogicOr}			{yylval.translation = yytext; return TK_OP_LOGIC_OR; }	
{OpLogicNot}		{yylval.translation = yytext; return TK_OP_LOGIC_NOT; }

{OpLogicBinAnd}			{yylval.translation = yytext; return TK_OP_BIN_AND; }
{OpLogicBinOr}			{yylval.translation = yytext; return TK_OP_BIN_OR; }
{OpLogicBinXor}			{yylval.translation = yytext; return TK_OP_BIN_XOR; }
{OpLogicBinNot}			{yylval.translation = yytext; return TK_OP_BIN_NOT; }
{OpLogicBinShiftR}		{yylval.translation = yytext; return TK_OP_BIN_SHIFTR; }
{OpLogicBinShiftL}		{yylval.translation = yytext; return TK_OP_BIN_SHIFTL; }


{Assign}	{ return TK_ASSIGN; }

{Int}		{ yylval.translation = yytext; return TK_INT; }
{Float}		{ yylval.translation = yytext; return TK_FLOAT; }
{Scientific}	{ yylval.translation = yytext; return TK_SCIENTIFIC; }
{Char}		{ yylval.translation = yytext; return TK_CHAR; }
{String}	{ yylval.translation = yytext; return TK_STRING; }
{Bool}		{ yylval.translation = yytext; return TK_BOOL; }

{TypeChar} 	{ yylval.translation = yytext; return TK_TYPE_CHAR; }
{TypeString} 	{ yylval.translation = yytext; return TK_TYPE_STRING; }
{TypeInt} 	{ yylval.translation = yytext; return TK_TYPE_INT; }
{TypeVoid} 	{ yylval.translation = yytext; return TK_TYPE_VOID; }
{TypeFloat} 	{ yylval.translation = yytext; return TK_TYPE_FLOAT; }
{TypeDouble} 	{ yylval.translation = yytext; return TK_TYPE_DOUBLE; }
{TypeBool} 	{ yylval.translation = yytext; return TK_TYPE_BOOL; }

{ModifierUnsigned} 	{ yylval.translation = yytext; return TK_MODIFIER_UNSIGNED; }
{ModifierSigned} 	{ yylval.translation = yytext; return TK_MODIFIER_SIGNED; }
{ModifierShort} 	{ yylval.translation = yytext; return TK_MODIFIER_SHORT; }
{ModifierLong} 	{ yylval.translation = yytext; return TK_MODIFIER_LONG; }

{Return} 	{ yylval.translation = yytext; return TK_RETURN; }

{Cout}		{ yylval.translation = yytext; return TK_COUT; }

{ID}		{ yylval.label = yytext; return TK_ID; }

.			{ *yytext; }

%%
